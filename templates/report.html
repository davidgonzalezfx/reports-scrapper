<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reporte Profesional</title>
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Source Sans Pro', sans-serif;
      background-color: #fff;
      color: #333;
      margin: 0;
      padding: 20px;
    }

    .presentation-container {
      width: 1280px;
      margin: 0 auto;
      background-color: #fff;
    }

    .slide {
      width: 1280px;
      min-height: 760px;
      margin-bottom: 20px;
      border: 1px solid #e0e0e0;
      background-color: #fff;
    }

    .slide-content {
      height: 100%;
    }

    /* Custom scrollbar styling */
    .slide::-webkit-scrollbar {
      width: 8px;
    }

    .slide::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 4px;
    }

    .slide::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 4px;
    }

    .slide::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.5);
    }


    /* Slide 1 styles */
    .slide-1 {
      background-image: url('/templates/images/report-background.jpeg');
      background-size: cover;
      background-position: 0 -8px;
      background-repeat: no-repeat;
      position: relative;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      align-items: center;
      text-align: center;
    }

    .slide-1::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(to bottom, rgba(0, 0, 0, 0.1) 0%, rgba(0, 0, 0, 0.6) 100%);
      z-index: 1;
    }

    .slide-1 .blue-section {
      position: relative;
      z-index: 2;
      width: 100%;
      background-color: rgba(15, 126, 194, 0.9);
      padding: 30px 70px;
      backdrop-filter: blur(2px);
    }

    .slide-1 .report-title {
      font-size: 60px;
      font-weight: 700;
      margin-bottom: 15px;
      letter-spacing: 1px;
    }

    .slide-1 .institution {
      font-size: 28px;
      margin-bottom: 10px;
      font-weight: 600;
    }

    .slide-1 .date-range {
      font-size: 24px;
      margin-bottom: 25px;
    }

    .slide-1 .logos {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 15px;
      border-top: 1px solid rgba(255, 255, 255, 0.3);
    }

    .slide-1 .logo {
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
    }

    .slide-1 .logo .material-icons {
      margin-right: 8px;
      font-size: 24px;
    }

    /* Common slide styles */
    .header {
      background-color: #0f7ec2;
      color: white;
      padding: 20px 70px;
      position: relative;
    }

    .title {
      font-size: 40px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .subtitle {
      font-size: 22px;
      font-weight: 400;
      opacity: 0.9;
    }

    .report-logo,
    .header-logo {
      position: absolute;
      top: 20px;
      right: 70px;
      height: 80px;
      width: auto;
    }

    .content {
      padding: 30px 70px;
      color: #333;
    }

    /* Slide 2 styles */
    .slide-2 {
      background-color: white;
    }

    .slide-2 .content {
      display: flex;
      flex-grow: 1;
    }

    .slide-2 .left-section {
      flex: 1;
      padding-right: 40px;
    }

    .slide-2 .right-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .slide-2 .stats-container {
      display: flex;
      margin-bottom: 30px;
    }

    .slide-2 .stat-box {
      flex: 1;
      background-color: #f5f7fa;
      border-radius: 8px;
      padding: 20px;
      margin-right: 15px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    .slide-2 .stat-box:last-child {
      margin-right: 0;
    }

    .slide-2 .stat-number {
      font-size: 36px;
      font-weight: 700;
      color: #0f7ec2;
      margin-bottom: 5px;
    }

    .slide-2 .stat-label {
      font-size: 18px;
      color: #555;
    }

    .slide-2 .activity-summary {
      margin-bottom: 30px;
    }

    .slide-2 .activity-title {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 15px;
      color: #0f7ec2;
    }

    .slide-2 .activity-stats {
      display: flex;
      justify-content: space-between;
    }

    .slide-2 .activity-item {
      text-align: center;
      flex: 1;
    }

    .slide-2 .activity-number {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .slide-2 .activity-name {
      font-size: 18px;
      color: #555;
    }

    .slide-2 .total-activities {
      text-align: center;
      margin-top: 20px;
      padding: 15px;
      background-color: #e3f2fd;
      border-radius: 8px;
    }

    .slide-2 .total-number {
      font-size: 36px;
      font-weight: 700;
      color: #0f7ec2;
    }

    .slide-2 .total-label {
      font-size: 18px;
      color: #555;
    }

    .slide-2 .chart-container {
      width: 100%;
      height: 300px;
      margin-bottom: 20px;
    }

    .slide-2 .activity-description {
      background-color: #f5f7fa;
      border-radius: 8px;
      padding: 15px;
      margin-top: 20px;
    }

    .slide-2 .description-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 10px;
      color: #0f7ec2;
    }

    .slide-2 .description-item {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
    }

    .slide-2 .description-item:last-child {
      margin-bottom: 0;
    }

    .slide-2 .description-icon {
      color: #0f7ec2;
      margin-right: 10px;
    }

    .slide-2 .description-text {
      font-size: 16px;
    }

    /* Slide 3 styles */
    .slide-3 {
      background-color: white;
    }

    .slide-3 .content {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
    }

    .slide-3 .activity-summary {
      display: flex;
      justify-content: space-between;
      margin-bottom: 30px;
    }

    .slide-3 .activity-card {
      flex: 1;
      background-color: #f5f7fa;
      border-radius: 8px;
      padding: 20px;
      margin-right: 15px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    .slide-3 .activity-card:last-child {
      margin-right: 0;
    }

    .slide-3 .activity-icon {
      color: #0f7ec2;
      font-size: 36px;
      margin-bottom: 10px;
    }

    .slide-3 .activity-number {
      font-size: 36px;
      font-weight: 700;
      color: #0f7ec2;
      margin-bottom: 5px;
    }

    .slide-3 .activity-name {
      font-size: 18px;
      color: #555;
    }

    .slide-3 .table-container {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .slide-3 .table-title {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 15px;
      color: #0f7ec2;
    }

    .slide-3 .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .slide-3 .data-table th {
      background-color: #e3f2fd;
      color: #0f7ec2;
      font-weight: 600;
      text-align: left;
      padding: 12px 15px;
      font-size: 18px;
    }

    .slide-3 .data-table td {
      padding: 10px 15px;
      border-bottom: 1px solid #e0e0e0;
      font-size: 16px;
    }

    .slide-3 .data-table tr:last-child td {
      border-bottom: none;
    }

    .slide-3 .total-row {
      background-color: #f5f7fa;
      font-weight: 600;
    }

    .slide-3 .total-row td {
      border-top: 2px solid #0f7ec2;
      border-bottom: 2px solid #0f7ec2;
    }

    .slide-3 .highlight {
      color: #0f7ec2;
      font-weight: 600;
    }

    .slide-3 .usage-bar {
      height: 8px;
      background-color: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 5px;
    }

    .slide-3 .usage-fill {
      height: 100%;
      background-color: #0f7ec2;
    }

    /* Slide 4 styles */
    .slide-4 {
      background-color: white;
    }

    .slide-4 .content {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
    }

    .slide-4 .charts-container {
      display: flex;
      flex-direction: column;
      gap: 30px;
      flex-grow: 1;
    }

    .slide-4 .chart-container {
      width: 100%;
      height: 250px;
      margin-bottom: 10px;
    }

    /* Slide 5 styles */
    .slide-5 {
      background-color: white;
    }

    .slide-5 .content {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
    }

    .slide-5 .classroom-info {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
    }

    .slide-5 .classroom-icon {
      color: #0f7ec2;
      font-size: 36px;
      margin-right: 15px;
    }

    .slide-5 .classroom-name {
      font-size: 28px;
      font-weight: 600;
      color: #0f7ec2;
    }

    .slide-5 .skills-table-container {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .slide-5 .skills-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .slide-5 .skills-table th {
      background-color: #e3f2fd;
      color: #0f7ec2;
      font-weight: 600;
      text-align: left;
      padding: 12px 15px;
      font-size: 18px;
    }

    .slide-5 .skills-table td {
      padding: 12px 15px;
      border-bottom: 1px solid #e0e0e0;
      font-size: 16px;
      vertical-align: middle;
    }

    .slide-5 .skills-table tr:last-child td {
      border-bottom: none;
    }

    .slide-5 .skill-name {
      font-weight: 600;
      width: 400px;
    }

    .slide-5 .correct-answers,
    .slide-5 .total-questions {
      text-align: center;
      font-weight: 600;
      font-size: 18px;
    }

    .slide-5 .accuracy-container {
      display: flex;
      align-items: center;
    }

    .slide-5 .accuracy-percentage {
      min-width: 50px;
      font-weight: 600;
      margin-right: 10px;
    }

    .slide-5 .progress-bar-container {
      flex-grow: 1;
      height: 12px;
      background-color: #e0e0e0;
      border-radius: 6px;
      overflow: hidden;
    }

    .slide-5 .progress-bar {
      height: 100%;
      background-color: #0f7ec2;
      border-radius: 6px;
    }

    .slide-5 .high-accuracy {
      color: #2e7d32;
    }

    .slide-5 .medium-accuracy {
      color: #f57c00;
    }

    .slide-5 .low-accuracy {
      color: #c62828;
    }

    .slide-5 .skill-category {
      font-size: 14px;
      color: #757575;
      margin-top: 2px;
    }

    .slide-5 .table-title {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 15px;
      margin-top: 30px;
      color: #0f7ec2;
    }

    /* Slide 6 styles */
    .slide-6 {
      background-color: white;
    }

    .slide-6 .content {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
      justify-content: center;
    }

    .slide-6 .table-container {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-grow: 1;
    }

    .slide-6 .top-readers-table {
      width: 90%;
      border: 3px solid #0f7ec2;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .slide-6 .table-header {
      background-color: #0f7ec2;
      color: white;
      padding: 15px 20px;
      text-align: center;
    }

    .slide-6 .table-title {
      font-size: 28px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .slide-6 .table-title .material-icons {
      margin-right: 10px;
      font-size: 32px;
    }

    .slide-6 .table-content {
      display: flex;
      flex-wrap: wrap;
    }

    .slide-6 .classroom-column {
      flex: 1;
      min-width: 300px;
      padding: 20px;
      border-right: 1px solid #e0e0e0;
    }

    .slide-6 .classroom-column:last-child {
      border-right: none;
    }

    .slide-6 .classroom-name {
      font-size: 20px;
      font-weight: 600;
      color: #0f7ec2;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
    }

    .slide-6 .classroom-name .material-icons {
      margin-right: 8px;
      font-size: 24px;
    }

    .slide-6 .student-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 15px;
      margin-bottom: 10px;
      background-color: #f5f7fa;
      border-radius: 8px;
      transition: all 0.2s ease;
    }

    .slide-6 .student-item:hover {
      background-color: #e3f2fd;
      transform: translateY(-2px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .slide-6 .student-name {
      font-size: 18px;
      font-weight: 600;
      flex: 1;
    }

    .slide-6 .student-score {
      font-size: 24px;
      font-weight: 700;
      color: #0f7ec2;
      background-color: white;
      padding: 5px 15px;
      border-radius: 20px;
      min-width: 60px;
      text-align: center;
    }

    .slide-6 .top-score {
      color: #2e7d32;
      background-color: #e8f5e9;
    }

    .slide-6 .medal {
      margin-right: 8px;
      color: #ffc107;
    }

    .slide-6 .date-info {
      text-align: center;
      margin-top: 20px;
      font-size: 18px;
      color: #555;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .slide-6 .date-info .material-icons {
      margin-right: 8px;
      color: #0f7ec2;
    }

    /* Slide 7 styles - Level Up Progress */
    .slide-7 {
      background-color: white;
    }

    .slide-7 .content {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
    }

    .slide-7 .classroom-info {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
    }

    .slide-7 .classroom-icon {
      color: #0f7ec2;
      font-size: 36px;
      margin-right: 15px;
    }

    .slide-7 .classroom-name {
      font-size: 28px;
      font-weight: 600;
      color: #0f7ec2;
    }

    .slide-7 .level-up-table-container {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .slide-7 .level-up-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .slide-7 .level-up-table th {
      background-color: #e3f2fd;
      color: #0f7ec2;
      font-weight: 600;
      text-align: left;
      padding: 12px 15px;
      font-size: 18px;
    }

    .slide-7 .level-up-table td {
      padding: 12px 15px;
      border-bottom: 1px solid #e0e0e0;
      font-size: 16px;
      vertical-align: middle;
    }

    .slide-7 .level-up-table tr:last-child td {
      border-bottom: none;
    }

    .slide-7 .student-name {
      font-weight: 600;
      max-width: 300px;
    }

    .slide-7 .level-info {
      text-align: center;
      font-weight: 600;
      font-size: 18px;
    }

    .slide-7 .progress-container {
      display: flex;
      align-items: center;
    }

    .slide-7 .progress-percentage {
      min-width: 50px;
      font-weight: 600;
      margin-right: 10px;
    }

    .slide-7 .progress-bar-container {
      flex-grow: 1;
      height: 12px;
      background-color: #e0e0e0;
      border-radius: 6px;
      overflow: hidden;
    }

    .slide-7 .progress-bar {
      height: 100%;
      background-color: #0f7ec2;
      border-radius: 6px;
    }

    .slide-7 .high-progress {
      color: #2e7d32;
    }

    .slide-7 .medium-progress {
      color: #f57c00;
    }

    .slide-7 .low-progress {
      color: #c62828;
    }
  </style>
</head>

<body>
  <div class="presentation-container">

    <!-- Slide 1: Title Slide -->
    <div class="slide slide-1">
      <img src="templates/images/b1-tech.png" alt="B1 Tech Logo" class="report-logo">
      <div class="blue-section">
        <div class="report-title">{{ report_title }}</div>
        <div class="institution">Unidad Educativa: {{ institution }}</div>
        <div class="date-range">{{ date_range }}</div>
        <div class="logos">
          {% for logo in logos %}
          <div class="logo">
            <i class="material-icons">{{ logo.icon }}</i>
            {{ logo.text }}
          </div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Slide 2: School Overview -->
    <div class="slide slide-2">
      <div class="slide-content">
        <div class="header">
          <div class="title">{{ school_overview.title }}</div>
          <div class="subtitle">{{ school_overview.subtitle }}</div>
          <img src="templates/images/logo-b1-tech-white.png" alt="B1 Tech Logo" class="header-logo">
        </div>
        <div class="content">
          <div class="left-section">
            <div class="stats-container">
              {% for stat in school_overview.stats %}
              <div class="stat-box">
                <div class="stat-number">{{ stat.number }}</div>
                <div class="stat-label">{{ stat.label }}</div>
              </div>
              {% endfor %}
            </div>

            <div class="activity-summary">
              <div class="activity-title">Resultados Resumen</div>
              <div class="activity-stats">
                {% for activity in school_overview.activities %}
                <div class="activity-item">
                  <div class="activity-number">{{ activity.number }}</div>
                  <div class="activity-name">{{ activity.name }}</div>
                </div>
                {% endfor %}
              </div>
            </div>

            <div class="total-activities">
              <div class="total-number">{{ school_overview.total_activities }}</div>
              <div class="total-label">Total de Actividades</div>
            </div>

            <div class="activity-description">
              <div class="description-title">Actividades</div>
              {% for desc in school_overview.activity_descriptions %}
              <div class="description-item">
                <i class="material-icons description-icon">{{ desc.icon }}</i>
                <div class="description-text">{{ desc.text }}</div>
              </div>
              {% endfor %}
            </div>
          </div>

          <div class="right-section">
            <div class="chart-container">
              <canvas id="activityChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Slide 3: Detailed Activities -->
    <div class="slide slide-3">
      <div class="slide-content">
        <div class="header">
          <div class="title">{{ detailed_activities.title }}</div>
          <div class="subtitle">{{ detailed_activities.subtitle }}</div>
          <img src="templates/images/logo-b1-tech-white.png" alt="B1 Tech Logo" class="header-logo">
        </div>
        <div class="content">
          <div class="activity-summary">
            {% for activity in detailed_activities.activity_summary %}
            <div class="activity-card">
              <i class="material-icons activity-icon">{{ activity.icon }}</i>
              <div class="activity-number">{{ activity.number }}</div>
              <div class="activity-name">{{ activity.name }}</div>
            </div>
            {% endfor %}
          </div>

          <div class="table-container">
            <div class="table-title">Detalle actividades por aula</div>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Aula</th>
                  <th>All Students</th>
                  <th>Students with activity</th>
                  <th>%</th>
                  <th>Listen</th>
                  <th>Read</th>
                  <th>Quiz</th>
                  <th>Interactivity</th>
                  <th>Practice Recording</th>
                </tr>
              </thead>
              <tbody>
                {% for classroom in detailed_activities.classrooms %}
                <tr>
                  <td>{{ classroom.name }}</td>
                  <td>{{ classroom.students }}</td>
                  <td>{{ classroom.students_used }}</td>
                  <td>
                    <div>{{ classroom.usage }}%</div>
                    <div class="usage-bar">
                      <div class="usage-fill" style="width: {{ classroom.usage }}%"></div>
                    </div>
                  </td>
                  <td>{{ classroom.listen }}</td>
                  <td>{{ classroom.read }}</td>
                  <td>{{ classroom.quiz }}</td>
                  <td>{{ classroom.interactivity }}</td>
                  <td>{{ classroom.practice_recording }}</td>
                </tr>
                {% endfor %}
                <tr class="total-row">
                  <td><span class="highlight">Total general</span></td>
                  <td><span class="highlight">{{ detailed_activities.total.students }}</span></td>
                  <td><span class="highlight">{{ detailed_activities.total.students_used }}</span></td>
                  <td><span class="highlight">{{ detailed_activities.total.usage }}%</span></td>
                  <td><span class="highlight">{{ detailed_activities.total.listen }}</span></td>
                  <td><span class="highlight">{{ detailed_activities.total.read }}</span></td>
                  <td><span class="highlight">{{ detailed_activities.total.quiz }}</span></td>
                  <td><span class="highlight">{{ detailed_activities.total.interactivity }}</span></td>
                  <td><span class="highlight">{{ detailed_activities.total.practice_recording }}</span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Slide 4: Classroom Activity Comparison -->
    <div class="slide slide-4">
      <div class="slide-content">
        <div class="header">
          <div class="title">COMPARACIÓN DE ACTIVIDADES POR AULA</div>
          <div class="subtitle">Análisis comparativo de Listen, Read y Quiz entre aulas</div>
          <img src="templates/images/logo-b1-tech-white.png" alt="B1 Tech Logo" class="header-logo">
        </div>
        <div class="content">
          <div class="charts-container">
            <div class="chart-container">
              <canvas id="listenChart"></canvas>
            </div>
            <div class="chart-container">
              <canvas id="readChart"></canvas>
            </div>
            <div class="chart-container">
              <canvas id="quizChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Skills Summary Slide (before per-classroom slides) -->
    {% if skills_summary and skills_summary.stats %}
    <div class="slide slide-2">
      <div class="slide-content">
        <div class="header">
          <div class="title">{{ skills_summary.title }}</div>
          <div class="subtitle">{{ skills_summary.subtitle }}</div>
          <img src="templates/images/logo-b1-tech-white.png" alt="B1 Tech Logo" class="header-logo">
        </div>
        <div class="content">
          <div class="left-section">
            <div class="stats-container">
              {% for stat in skills_summary.stats %}
              <div class="stat-box">
                <div class="stat-number">{{ stat.number }}</div>
                <div class="stat-label">{{ stat.label }}</div>
              </div>
              {% endfor %}
            </div>

            <div class="activity-summary">
              <div class="activity-title">Totales Generales</div>
              <div class="activity-stats">
                <div class="activity-item">
                  <div class="activity-number">{{ skills_summary.totals.correct }}</div>
                  <div class="activity-name">Correctas</div>
                </div>
                <div class="activity-item">
                  <div class="activity-number">{{ skills_summary.totals.total }}</div>
                  <div class="activity-name">Total Preguntas</div>
                </div>
              </div>
            </div>

            <div class="total-activities">
              <div class="total-number">{{ skills_summary.totals.accuracy }}%</div>
              <div class="total-label">Precisión General</div>
            </div>

            <div class="activity-description">
              <div class="description-title">Top 5 Habilidades</div>
              {% for skill in skills_summary.top_skills %}
              <div class="description-item">
                <i class="material-icons description-icon">check_circle</i>
                <div class="description-text">{{ skill.name }}: {{ skill.accuracy }}%</div>
              </div>
              {% endfor %}
            </div>
          </div>

          <div class="right-section">
            <div class="chart-container">
              <canvas id="skillsChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}

    <!-- Reading Skills Slides (Dynamic - one per classroom) -->
    {% for classroom_data in reading_skills %}
    <div class="slide slide-5">
      <div class="slide-content">
        <div class="header">
          <div class="title">HABILIDADES DE COMPRENSIÓN LECTORA</div>
          <div class="subtitle">Análisis de habilidades de lectura por aula</div>
          <img src="templates/images/logo-b1-tech-white.png" alt="B1 Tech Logo" class="header-logo">
        </div>
        <div class="content">
          <div class="classroom-info">
            <i class="material-icons classroom-icon">groups</i>
            <div class="classroom-name">Aula: {{ classroom_data.classroom }}</div>
          </div>

          <div class="skills-table-container">
            <table class="skills-table">
              <thead>
                <tr>
                  <th>Skill</th>
                  <th>Correct</th>
                  <th>Total</th>
                  <th>Accuracy</th>
                </tr>
              </thead>
              <tbody>
                {% for skill in classroom_data.skills %}
                <tr>
                  <td>
                    <div class="skill-name">{{ skill.name }}</div>
                  </td>
                  <td class="correct-answers">{{ skill.correct }}</td>
                  <td class="total-questions">{{ skill.total }}</td>
                  <td>
                    <div class="accuracy-container">
                      <div class="accuracy-percentage
                                                {% if skill.accuracy >= 80 %}high-accuracy
                                                {% elif skill.accuracy >= 60 %}medium-accuracy
                                                {% else %}low-accuracy{% endif %}">
                        {{ skill.accuracy }}%
                      </div>
                      <div class="progress-bar-container">
                        <div class="progress-bar" style="width: {{ skill.accuracy }}%"></div>
                      </div>
                    </div>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>

            <div class="table-title">Top 5 Skills by Accuracy</div>
            <table class="skills-table">
              <thead>
                <tr>
                  <th>Skill</th>
                  <th>Correct</th>
                  <th>Total</th>
                  <th>Accuracy</th>
                </tr>
              </thead>
              <tbody>
                {% set top_skills = classroom_data.skills | sort(attribute='accuracy', reverse=True) | list %}
                {% for skill in top_skills[:5] %}
                <tr>
                  <td>
                    <div class="skill-name">{{ skill.name }}</div>
                  </td>
                  <td class="correct-answers">{{ skill.correct }}</td>
                  <td class="total-questions">{{ skill.total }}</td>
                  <td>
                    <div class="accuracy-container">
                      <div class="accuracy-percentage
                                                {% if skill.accuracy >= 80 %}high-accuracy
                                                {% elif skill.accuracy >= 60 %}medium-accuracy
                                                {% else %}low-accuracy{% endif %}">
                        {{ skill.accuracy }}%
                      </div>
                      <div class="progress-bar-container">
                        <div class="progress-bar" style="width: {{ skill.accuracy }}%"></div>
                      </div>
                    </div>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}

    <!-- Level Up Progress Slides (Dynamic - one per classroom) -->
    {% for classroom_data in level_up_progress %}
    <div class="slide slide-7">
      <div class="slide-content">
        <div class="header">
          <div class="title">PROGRESO DE NIVEL</div>
          <div class="subtitle">Análisis de progreso de nivel por aula</div>
          <img src="templates/images/logo-b1-tech-white.png" alt="B1 Tech Logo" class="header-logo">
        </div>
        <div class="content">
          <div class="classroom-info">
            <i class="material-icons classroom-icon">trending_up</i>
            <div class="classroom-name">Aula: {{ classroom_data.classroom }}</div>
          </div>

          <div class="level-up-table-container">
            <table class="level-up-table">
              <thead>
                <tr>
                  <th>Student</th>
                  <th>Level</th>
                  <th>Progress (%)</th>
                </tr>
              </thead>
              <tbody>
                {% for student in classroom_data.students %}
                <tr>
                  <td>
                    <div class="student-name">{{ student.student }}</div>
                  </td>
                  <td class="level-info">{{ student.level }}</td>
                  <td>
                    <div class="progress-container">
                      <div class="progress-percentage
                                                {% if student.progress >= 80 %}high-progress
                                                {% elif student.progress >= 60 %}medium-progress
                                                {% else %}low-progress{% endif %}">
                        {{ "%.1f"|format(student.progress) }}%
                      </div>
                      <div class="progress-bar-container">
                        <div class="progress-bar" style="width: {{ student.progress }}%"></div>
                      </div>
                    </div>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}

    <!-- Slide 6: Top Readers -->
    <div class="slide slide-6">
      <div class="slide-content">
        <div class="header">
          <div class="title">{{ top_readers.title }}</div>
          <div class="subtitle">{{ top_readers.subtitle }}</div>
          <img src="templates/images/logo-b1-tech-white.png" alt="B1 Tech Logo" class="header-logo">
        </div>
        <div class="content">
          <div class="table-container">
            <div class="top-readers-table">
              <div class="table-header">
                <div class="table-title">
                  <i class="material-icons">emoji_events</i>
                  Los mejores por aula
                </div>
              </div>
              <div class="table-content">
                {% for classroom in top_readers.classrooms %}
                <div class="classroom-column">
                  <div class="classroom-name">
                    <i class="material-icons">school</i>
                    {{ classroom.name }}
                  </div>
                  {% for student in classroom.students %}
                  <div class="student-item">
                    <div class="student-name">
                      {{ student.name }}
                    </div>
                    <div class="student-score">
                      {{ student.score }}
                    </div>
                  </div>
                  {% endfor %}
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
          <div class="date-info">
            <i class="material-icons">date_range</i>
            Período: {{ top_readers.subtitle }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Initialize Chart.js for slide 2
    Chart.register(ChartDataLabels);
    const ctx = document.getElementById('activityChart').getContext('2d');
    const activityChart = new Chart(ctx, {
      type: 'pie',
      data: {
        labels: ['Listen', 'Read', 'Quiz'],
        datasets: [{
          data: [{{ school_overview.chart_data | join(', ') }}],
        backgroundColor: [
          '#64B5F6',
          '#1976D2',
          '#0D47A1'
        ],
        borderColor: 'white',
        borderWidth: 2
      }]
    },
      options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: 'bottom',
          labels: {
            font: {
              size: 16
            },
            padding: 20
          }
        },
        tooltip: {
          callbacks: {
            label: function (context) {
              return context.label + ': ' + context.raw + '%';
            }
          }
        },
        datalabels: {
          formatter: (value, ctx) => {
            return value + '%';
          },
          color: 'white',
          font: {
            size: 14,
            weight: 'bold'
          }
        }
      }
    }
        });

    // Initialize Chart.js for slide 4 - Classroom Comparison Charts
    const listenCtx = document.getElementById('listenChart').getContext('2d');
    const listenChart = new Chart(listenCtx, {
      type: 'bar',
      data: {
        labels: {{ classroom_comparison.labels | tojson }},
    datasets: [{
      label: 'Listen',
      data: {{ classroom_comparison.listen | tojson }},
      backgroundColor: '#64B5F6',
      borderColor: '#0f7ec2',
      borderWidth: 1
                }]
            },
    options: {
      responsive: true,
        maintainAspectRatio: false,
          plugins: {
        title: {
          display: true,
            text: 'Listen Activities',
              font: {
            size: 18,
              weight: 'bold'
          },
          padding: {
            top: 10,
              bottom: 20
          }
        },
        legend: {
          display: false
        },
        datalabels: {
          color: 'white',
            font: {
            weight: 'bold',
              size: 12
          },
          formatter: function(value) {
            return value;
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
            title: {
            display: true,
              text: 'Total Activities'
          },
          grid: {
            display: false
          }
        },
        x: {
          title: {
            display: true,
              text: 'Classrooms'
          },
          grid: {
            display: false
          }
        }
      }
    }
        });

    const readCtx = document.getElementById('readChart').getContext('2d');
    const readChart = new Chart(readCtx, {
      type: 'bar',
      data: {
        labels: {{ classroom_comparison.labels | tojson }},
    datasets: [{
      label: 'Read',
      data: {{ classroom_comparison.read | tojson }},
      backgroundColor: '#1976D2',
      borderColor: '#0D47A1',
      borderWidth: 1
                }]
            },
    options: {
      responsive: true,
        maintainAspectRatio: false,
          plugins: {
        title: {
          display: true,
            text: 'Read Activities',
              font: {
            size: 18,
              weight: 'bold'
          },
          padding: {
            top: 10,
              bottom: 20
          }
        },
        legend: {
          display: false
        },
        datalabels: {
          color: 'white',
            font: {
            weight: 'bold',
              size: 12
          },
          formatter: function(value) {
            return value;
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
            title: {
            display: true,
              text: 'Total Activities'
          },
          grid: {
            display: false
          }
        },
        x: {
          title: {
            display: true,
              text: 'Classrooms'
          },
          grid: {
            display: false
          }
        }
      }
    }
        });

    const quizCtx = document.getElementById('quizChart').getContext('2d');
    const quizChart = new Chart(quizCtx, {
      type: 'bar',
      data: {
        labels: {{ classroom_comparison.labels | tojson }},
    datasets: [{
      label: 'Quiz',
      data: {{ classroom_comparison.quiz | tojson }},
      backgroundColor: '#0D47A1',
      borderColor: '#000051',
      borderWidth: 1
                }]
            },
    options: {
      responsive: true,
        maintainAspectRatio: false,
          plugins: {
        title: {
          display: true,
            text: 'Quiz Activities',
              font: {
            size: 18,
              weight: 'bold'
          },
          padding: {
            top: 10,
              bottom: 20
          }
        },
        legend: {
          display: false
        },
        datalabels: {
          color: 'white',
            font: {
            weight: 'bold',
              size: 12
          },
          formatter: function(value) {
            return value;
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
            title: {
            display: true,
              text: 'Total Activities'
          },
          grid: {
            display: false
          }
        },
        x: {
          title: {
            display: true,
              text: 'Classrooms'
          },
          grid: {
            display: false
          }
        }
      }
    }
        });

    // Initialize Chart.js for Skills Summary Slide
    {% if skills_summary and skills_summary.stats %}
    const skillsCtx = document.getElementById('skillsChart');
    if (skillsCtx) {
      const skillsChart = new Chart(skillsCtx.getContext('2d'), {
        type: 'pie',
        data: {
          labels: ['Alta (≥80%)', 'Media (60-79%)', 'Baja (<60%)'],
          datasets: [{
            data: [{{ skills_summary.chart_data | join(', ') }}],
            backgroundColor: [
              '#64B5F6',
              '#1976D2',
              '#0D47A1'
            ],
            borderColor: 'white',
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                font: {
                  size: 14
                },
                padding: 15
              }
            },
            title: {
              display: true,
              text: 'Distribución de Precisión por Habilidad',
              font: {
                size: 18,
                weight: 'bold'
              },
              padding: {
                top: 10,
                bottom: 20
              }
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.label + ': ' + context.raw + ' habilidades';
                }
              }
            },
            datalabels: {
              formatter: (value, ctx) => {
                if (value === 0) return '';
                return value;
              },
              color: 'white',
              font: {
                size: 14,
                weight: 'bold'
              }
            }
          }
        }
      });
    }
    {% endif %}
  </script>
</body>

</html>
